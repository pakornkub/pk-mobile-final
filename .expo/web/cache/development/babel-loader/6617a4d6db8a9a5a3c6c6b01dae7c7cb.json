{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport { useMutation } from \"react-query\";\nimport { useDispatch } from \"react-redux\";\nimport { httpClient } from \"../services/axios\";\nimport { setAuth } from \"../contexts/slices/authSlice\";\nexport var useAuthLogin = function useAuthLogin() {\n  var dispatch = useDispatch();\n\n  var getAuthLogin = function _callee(params) {\n    var data;\n    return _regeneratorRuntime.async(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            data = new FormData();\n            Object.keys(params).forEach(function (value) {\n              data.append(value, params[value] || \"\");\n            });\n            data.append('platform', \"MA\");\n            _context.next = 5;\n            return _regeneratorRuntime.awrap(httpClient.post(\"/login\", data));\n\n          case 5:\n            return _context.abrupt(\"return\", _context.sent);\n\n          case 6:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  return useMutation(\"AuthLogin\", function (params) {\n    return getAuthLogin(params);\n  }, {\n    onSuccess: function onSuccess(response) {\n      dispatch(setAuth(response.data));\n    },\n    onError: function onError(error) {\n      var _error$response, _error$response$data;\n\n      console.log((error == null ? void 0 : (_error$response = error.response) == null ? void 0 : (_error$response$data = _error$response.data) == null ? void 0 : _error$response$data.message) || error.message);\n    }\n  });\n};\nexport var useRefreshToken = function useRefreshToken() {\n  var dispatch = useDispatch();\n\n  var getRefreshToken = function _callee2() {\n    return _regeneratorRuntime.async(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.next = 2;\n            return _regeneratorRuntime.awrap(httpClient.get(\"/refresh_token\"));\n\n          case 2:\n            return _context2.abrupt(\"return\", _context2.sent);\n\n          case 3:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  return useMutation(\"RefreshToken\", function () {\n    return getRefreshToken();\n  }, {\n    onSuccess: function onSuccess(response) {\n      dispatch(setAuth(response.data));\n    },\n    onError: function onError(error) {\n      var _error$response2, _error$response2$data;\n\n      console.log((error == null ? void 0 : (_error$response2 = error.response) == null ? void 0 : (_error$response2$data = _error$response2.data) == null ? void 0 : _error$response2$data.message) || error.message);\n    }\n  });\n};","map":{"version":3,"names":["useMutation","useDispatch","httpClient","setAuth","useAuthLogin","dispatch","getAuthLogin","params","data","FormData","Object","keys","forEach","value","append","post","onSuccess","response","onError","error","console","log","message","useRefreshToken","getRefreshToken","get"],"sources":["D:/Dev/pk-mobile/src/hooks/useLogin.ts"],"sourcesContent":["import { useMutation } from \"react-query\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport { httpClient } from \"../services/axios\";\r\n\r\nimport { REACT_APP_PLATFORM } from '@env';\r\n\r\nimport { setAuth } from \"../contexts/slices/authSlice\";\r\n\r\nimport { IAuthLoginParams } from \"../types/views/Login\";\r\nimport { IAuthLoginResult } from \"../types/hooks/Login\";\r\n\r\nexport const useAuthLogin = () => {\r\n  const dispatch = useDispatch();\r\n\r\n  const getAuthLogin = async (params: any): Promise<IAuthLoginResult> => {\r\n    let data = new FormData();\r\n\r\n    Object.keys(params).forEach((value) => {\r\n      data.append(value, params[value] || \"\");\r\n    });\r\n\r\n    data.append('platform', `${REACT_APP_PLATFORM}`);\r\n\r\n    return await httpClient.post(\"/login\", data);\r\n  };\r\n\r\n  return useMutation<IAuthLoginResult, any, IAuthLoginParams>(\r\n    \"AuthLogin\",\r\n    (params) => getAuthLogin(params),\r\n    {\r\n      onSuccess: (response) => {\r\n\r\n        dispatch(setAuth(response.data));\r\n\r\n      },\r\n      onError: (error) => {\r\n\r\n        console.log(error?.response?.data?.message || error.message);\r\n\r\n      },\r\n    }\r\n  );\r\n};\r\n\r\nexport const useRefreshToken = () => {\r\n\r\n  const dispatch = useDispatch();\r\n\r\n  const getRefreshToken = async (): Promise<IAuthLoginResult> => {\r\n\r\n    return await httpClient.get(\"/refresh_token\");\r\n  };\r\n\r\n  return useMutation<IAuthLoginResult, any>(\r\n    \"RefreshToken\",\r\n    () => getRefreshToken(),\r\n    {\r\n      onSuccess: (response) => {\r\n\r\n        dispatch(setAuth(response.data));\r\n\r\n      },\r\n      onError: (error) => {\r\n\r\n        console.log(error?.response?.data?.message || error.message);\r\n\r\n      },\r\n    }\r\n  );\r\n};\r\n"],"mappings":";AAAA,SAASA,WAAT,QAA4B,aAA5B;AACA,SAASC,WAAT,QAA4B,aAA5B;AACA,SAASC,UAAT;AAIA,SAASC,OAAT;AAKA,OAAO,IAAMC,YAAY,GAAG,SAAfA,YAAe,GAAM;EAChC,IAAMC,QAAQ,GAAGJ,WAAW,EAA5B;;EAEA,IAAMK,YAAY,GAAG,iBAAOC,MAAP;IAAA;IAAA;MAAA;QAAA;UAAA;YACfC,IADe,GACR,IAAIC,QAAJ,EADQ;YAGnBC,MAAM,CAACC,IAAP,CAAYJ,MAAZ,EAAoBK,OAApB,CAA4B,UAACC,KAAD,EAAW;cACrCL,IAAI,CAACM,MAAL,CAAYD,KAAZ,EAAmBN,MAAM,CAACM,KAAD,CAAN,IAAiB,EAApC;YACD,CAFD;YAIAL,IAAI,CAACM,MAAL,CAAY,UAAZ;YAPmB;YAAA,iCASNZ,UAAU,CAACa,IAAX,CAAgB,QAAhB,EAA0BP,IAA1B,CATM;;UAAA;YAAA;;UAAA;UAAA;YAAA;QAAA;MAAA;IAAA;EAAA,CAArB;;EAYA,OAAOR,WAAW,CAChB,WADgB,EAEhB,UAACO,MAAD;IAAA,OAAYD,YAAY,CAACC,MAAD,CAAxB;EAAA,CAFgB,EAGhB;IACES,SAAS,EAAE,mBAACC,QAAD,EAAc;MAEvBZ,QAAQ,CAACF,OAAO,CAACc,QAAQ,CAACT,IAAV,CAAR,CAAR;IAED,CALH;IAMEU,OAAO,EAAE,iBAACC,KAAD,EAAW;MAAA;;MAElBC,OAAO,CAACC,GAAR,CAAY,CAAAF,KAAK,QAAL,+BAAAA,KAAK,CAAEF,QAAP,6DAAiBT,IAAjB,0CAAuBc,OAAvB,KAAkCH,KAAK,CAACG,OAApD;IAED;EAVH,CAHgB,CAAlB;AAgBD,CA/BM;AAiCP,OAAO,IAAMC,eAAe,GAAG,SAAlBA,eAAkB,GAAM;EAEnC,IAAMlB,QAAQ,GAAGJ,WAAW,EAA5B;;EAEA,IAAMuB,eAAe,GAAG;IAAA;MAAA;QAAA;UAAA;YAAA;YAAA,iCAETtB,UAAU,CAACuB,GAAX,CAAe,gBAAf,CAFS;;UAAA;YAAA;;UAAA;UAAA;YAAA;QAAA;MAAA;IAAA;EAAA,CAAxB;;EAKA,OAAOzB,WAAW,CAChB,cADgB,EAEhB;IAAA,OAAMwB,eAAe,EAArB;EAAA,CAFgB,EAGhB;IACER,SAAS,EAAE,mBAACC,QAAD,EAAc;MAEvBZ,QAAQ,CAACF,OAAO,CAACc,QAAQ,CAACT,IAAV,CAAR,CAAR;IAED,CALH;IAMEU,OAAO,EAAE,iBAACC,KAAD,EAAW;MAAA;;MAElBC,OAAO,CAACC,GAAR,CAAY,CAAAF,KAAK,QAAL,gCAAAA,KAAK,CAAEF,QAAP,+DAAiBT,IAAjB,2CAAuBc,OAAvB,KAAkCH,KAAK,CAACG,OAApD;IAED;EAVH,CAHgB,CAAlB;AAgBD,CAzBM"},"metadata":{},"sourceType":"module"}