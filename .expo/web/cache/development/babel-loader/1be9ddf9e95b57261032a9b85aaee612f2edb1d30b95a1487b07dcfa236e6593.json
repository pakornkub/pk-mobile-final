{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { useMutation } from \"react-query\";\nimport { useDispatch } from \"react-redux\";\nimport { httpClient } from \"../services/axios\";\nimport { setAuth } from \"../contexts/slices/authSlice\";\nexport var useAuthLogin = function useAuthLogin() {\n  var dispatch = useDispatch();\n  var getAuthLogin = function () {\n    var _ref = _asyncToGenerator(function* (params) {\n      var data = new FormData();\n      Object.keys(params).forEach(function (value) {\n        data.append(value, params[value] || \"\");\n      });\n      data.append('platform', \"MA\");\n      return yield httpClient.post(\"/login\", data);\n    });\n    return function getAuthLogin(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n  return useMutation(\"AuthLogin\", function (params) {\n    return getAuthLogin(params);\n  }, {\n    onSuccess: function onSuccess(response) {\n      dispatch(setAuth(response.data));\n    },\n    onError: function onError(error) {\n      var _error$response, _error$response$data;\n      console.log((error == null ? void 0 : (_error$response = error.response) == null ? void 0 : (_error$response$data = _error$response.data) == null ? void 0 : _error$response$data.message) || error.message);\n    }\n  });\n};\nexport var useRefreshToken = function useRefreshToken() {\n  var dispatch = useDispatch();\n  var getRefreshToken = function () {\n    var _ref2 = _asyncToGenerator(function* () {\n      return yield httpClient.get(\"/refresh_token\");\n    });\n    return function getRefreshToken() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n  return useMutation(\"RefreshToken\", function () {\n    return getRefreshToken();\n  }, {\n    onSuccess: function onSuccess(response) {\n      dispatch(setAuth(response.data));\n    },\n    onError: function onError(error) {\n      var _error$response2, _error$response2$data;\n      console.log((error == null ? void 0 : (_error$response2 = error.response) == null ? void 0 : (_error$response2$data = _error$response2.data) == null ? void 0 : _error$response2$data.message) || error.message);\n    }\n  });\n};","map":{"version":3,"names":["useMutation","useDispatch","httpClient","setAuth","useAuthLogin","dispatch","getAuthLogin","_ref","_asyncToGenerator","params","data","FormData","Object","keys","forEach","value","append","post","_x","apply","arguments","onSuccess","response","onError","error","_error$response","_error$response$data","console","log","message","useRefreshToken","getRefreshToken","_ref2","get","_error$response2","_error$response2$data"],"sources":["D:/_Dev/expo/pk-mobile/src/hooks/useLogin.ts"],"sourcesContent":["import { useMutation } from \"react-query\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport { httpClient } from \"../services/axios\";\r\n\r\nimport { REACT_APP_PLATFORM } from '@env';\r\n\r\nimport { setAuth } from \"../contexts/slices/authSlice\";\r\n\r\nimport { IAuthLoginParams } from \"../types/views/Login\";\r\nimport { IAuthLoginResult } from \"../types/hooks/Login\";\r\n\r\nexport const useAuthLogin = () => {\r\n  const dispatch = useDispatch();\r\n\r\n  const getAuthLogin = async (params: any): Promise<IAuthLoginResult> => {\r\n    let data = new FormData();\r\n\r\n    Object.keys(params).forEach((value) => {\r\n      data.append(value, params[value] || \"\");\r\n    });\r\n\r\n    data.append('platform', `${REACT_APP_PLATFORM}`);\r\n\r\n    return await httpClient.post(\"/login\", data);\r\n  };\r\n\r\n  return useMutation<IAuthLoginResult, any, IAuthLoginParams>(\r\n    \"AuthLogin\",\r\n    (params) => getAuthLogin(params),\r\n    {\r\n      onSuccess: (response) => {\r\n\r\n        dispatch(setAuth(response.data));\r\n\r\n      },\r\n      onError: (error) => {\r\n\r\n        console.log(error?.response?.data?.message || error.message);\r\n\r\n      },\r\n    }\r\n  );\r\n};\r\n\r\nexport const useRefreshToken = () => {\r\n\r\n  const dispatch = useDispatch();\r\n\r\n  const getRefreshToken = async (): Promise<IAuthLoginResult> => {\r\n\r\n    return await httpClient.get(\"/refresh_token\");\r\n  };\r\n\r\n  return useMutation<IAuthLoginResult, any>(\r\n    \"RefreshToken\",\r\n    () => getRefreshToken(),\r\n    {\r\n      onSuccess: (response) => {\r\n\r\n        dispatch(setAuth(response.data));\r\n\r\n      },\r\n      onError: (error) => {\r\n\r\n        console.log(error?.response?.data?.message || error.message);\r\n\r\n      },\r\n    }\r\n  );\r\n};\r\n"],"mappings":";AAAA,SAASA,WAAW,QAAQ,aAAa;AACzC,SAASC,WAAW,QAAQ,aAAa;AACzC,SAASC,UAAU;AAInB,SAASC,OAAO;AAKhB,OAAO,IAAMC,YAAY,GAAG,SAAfA,YAAYA,CAAA,EAAS;EAChC,IAAMC,QAAQ,GAAGJ,WAAW,CAAC,CAAC;EAE9B,IAAMK,YAAY;IAAA,IAAAC,IAAA,GAAAC,iBAAA,CAAG,WAAOC,MAAW,EAAgC;MACrE,IAAIC,IAAI,GAAG,IAAIC,QAAQ,CAAC,CAAC;MAEzBC,MAAM,CAACC,IAAI,CAACJ,MAAM,CAAC,CAACK,OAAO,CAAC,UAACC,KAAK,EAAK;QACrCL,IAAI,CAACM,MAAM,CAACD,KAAK,EAAEN,MAAM,CAACM,KAAK,CAAC,IAAI,EAAE,CAAC;MACzC,CAAC,CAAC;MAEFL,IAAI,CAACM,MAAM,CAAC,UAAU,MAAyB,CAAC;MAEhD,aAAad,UAAU,CAACe,IAAI,CAAC,QAAQ,EAAEP,IAAI,CAAC;IAC9C,CAAC;IAAA,gBAVKJ,YAAYA,CAAAY,EAAA;MAAA,OAAAX,IAAA,CAAAY,KAAA,OAAAC,SAAA;IAAA;EAAA,GAUjB;EAED,OAAOpB,WAAW,CAChB,WAAW,EACX,UAACS,MAAM;IAAA,OAAKH,YAAY,CAACG,MAAM,CAAC;EAAA,GAChC;IACEY,SAAS,EAAE,SAAAA,UAACC,QAAQ,EAAK;MAEvBjB,QAAQ,CAACF,OAAO,CAACmB,QAAQ,CAACZ,IAAI,CAAC,CAAC;IAElC,CAAC;IACDa,OAAO,EAAE,SAAAA,QAACC,KAAK,EAAK;MAAA,IAAAC,eAAA,EAAAC,oBAAA;MAElBC,OAAO,CAACC,GAAG,CAAC,CAAAJ,KAAK,qBAAAC,eAAA,GAALD,KAAK,CAAEF,QAAQ,sBAAAI,oBAAA,GAAfD,eAAA,CAAiBf,IAAI,qBAArBgB,oBAAA,CAAuBG,OAAO,KAAIL,KAAK,CAACK,OAAO,CAAC;IAE9D;EACF,CACF,CAAC;AACH,CAAC;AAED,OAAO,IAAMC,eAAe,GAAG,SAAlBA,eAAeA,CAAA,EAAS;EAEnC,IAAMzB,QAAQ,GAAGJ,WAAW,CAAC,CAAC;EAE9B,IAAM8B,eAAe;IAAA,IAAAC,KAAA,GAAAxB,iBAAA,CAAG,aAAuC;MAE7D,aAAaN,UAAU,CAAC+B,GAAG,CAAC,gBAAgB,CAAC;IAC/C,CAAC;IAAA,gBAHKF,eAAeA,CAAA;MAAA,OAAAC,KAAA,CAAAb,KAAA,OAAAC,SAAA;IAAA;EAAA,GAGpB;EAED,OAAOpB,WAAW,CAChB,cAAc,EACd;IAAA,OAAM+B,eAAe,CAAC,CAAC;EAAA,GACvB;IACEV,SAAS,EAAE,SAAAA,UAACC,QAAQ,EAAK;MAEvBjB,QAAQ,CAACF,OAAO,CAACmB,QAAQ,CAACZ,IAAI,CAAC,CAAC;IAElC,CAAC;IACDa,OAAO,EAAE,SAAAA,QAACC,KAAK,EAAK;MAAA,IAAAU,gBAAA,EAAAC,qBAAA;MAElBR,OAAO,CAACC,GAAG,CAAC,CAAAJ,KAAK,qBAAAU,gBAAA,GAALV,KAAK,CAAEF,QAAQ,sBAAAa,qBAAA,GAAfD,gBAAA,CAAiBxB,IAAI,qBAArByB,qBAAA,CAAuBN,OAAO,KAAIL,KAAK,CAACK,OAAO,CAAC;IAE9D;EACF,CACF,CAAC;AACH,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}